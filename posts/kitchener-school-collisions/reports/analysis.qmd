---
title: "Kitchener School Collisions"
image: "images/map_snapshot.JPG"
date: "2024-12-18"
categories: [Open Data, R, Policy]
warning: false
message: false
echo: false
---

## Collisions Within 250m of Kitchener Schools (Jan 2015-June 2022)

```{r}
#| label: load-packages-sources
here::i_am("posts/kitchener-school-collisions/reports/analysis.qmd")

library(gt)
library(here)

source(here("posts", "kitchener-school-collisions", "R", "helpers.R"))
```

```{r}
#| label: load-data

all_collisions <- read_csv(here("posts", "kitchener-school-collisions", "data", "collisions_with_proximity_to_schools.csv"))
collisions_near_schools <- read_csv(here("posts", "kitchener-school-collisions", "data", "schools_collision_summary.csv"))
```

```{r}
#| label: collisions-by-time-window

collisions_near_schools |> 
  filter(!is.na(time_window)) |> 
  group_by(time_window) |> 
  summarise(across(ends_with("_collisions"), sum), .groups = "drop") |> 
  gt()

```

```{r}
#| label: filter-6AM-6PM-collisions-only

collisions_btw_6am_6pm <- collisions_near_schools |> 
  filter(grepl("6am", time_window))
```

The interactive map below reports the types and number of collisions that took place on a school day between 6AM and 6PM within 250m of schools in Kitchener. Hover over a bubble to see the school name and click on it to see collision details. A bubble with a number indicates multiple underlying schools. Click on it to zoom in and see bubbles for the individual schools.

```{r}
#| label: map-collisions

map <- create_school_collision_map(collisions_btw_6am_6pm)

map
```
