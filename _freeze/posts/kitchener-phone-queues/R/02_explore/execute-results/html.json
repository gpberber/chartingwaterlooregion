{
  "hash": "a3c2a2a602654aed9e7194a8d5f06384",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Phone Queue Data Exploration\"\nauthor: \"gpb\"\ndate: \"2025-02-06\"\noutput: html_document\ndraft: true\n---\n\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 2\n# Groups:   num_metrics [5]\n  num_metrics     n\n        <int> <int>\n1           8     7\n2           9     5\n3          17  1589\n4          24     1\n5          33     1\n```\n\n\n:::\n:::\n\n\n\n\n\nAll but 14 (\\< 1%) of the approximately 1,600 dates have 17 metrics. The two dates with more than 17 metrics have two different values reported for some of the metrics and it's not possible to tell which ones are correct, so we'll drop them all. We could impute missing values for the 12 dates that have an incomplete set of 17, but since they represent such a small proportion of the data, we'll just drop them.\n\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"Avg Handle Time\"                                                          \n [2] \"Avg Queue Time\"                                                           \n [3] \"Avg Speed of Answer\"                                                      \n [4] \"Calls Abandoned\"                                                          \n [5] \"Calls Abandoned < Service Level\"                                          \n [6] \"Calls Handled\"                                                            \n [7] \"Calls Handled < Service Level\"                                            \n [8] \"Calls Presented\"                                                          \n [9] \"Max Handle Time\"                                                          \n[10] \"Max Queue Time\"                                                           \n[11] \"Percentage of Calls Abandoned\"                                            \n[12] \"Percentage of Calls Handled\"                                              \n[13] \"Percentage of Service Level Met (Handled)\"                                \n[14] \"Percentage of Service Level Met (With Abandoned Calls Counted Negatively)\"\n[15] \"Percentage of Service Level Met (With Abandoned Calls Counted Positively)\"\n[16] \"Percentage of Service Level Met (Without Abandoned Calls)\"                \n[17] \"Service Level (sec)\"                                                      \n```\n\n\n:::\n:::\n\n\n\n\n\nAll remaining dates have the same set of 17 metrics.\n\n#### Metric Definitions\n\nHere are the definitions of the metrics (as provided by Claude.ai):\n\n**Avg Handle Time**: Average duration of calls from answer to disconnect, including hold time.\n\n**Avg Queue Time**: Average wait time in queue for all calls (both answered and abandoned).\n\n**Avg Speed of Answer**: Average wait time for answered calls only.\n\n**Calls Abandoned**: Total number of calls where the caller hung up while in queue.\n\n**Calls Abandoned \\< Service Level**: Number of calls abandoned before the service level threshold (e.g., 30 seconds).\n\n**Calls Handled**: Total number of calls answered by agents.\n\n**Calls Handled \\< Service Level**: Number of calls answered before the service level threshold.\n\n**Calls Presented**: Total number of calls entering the queue.\n\n**Max Handle Time**: Longest duration of any single call from answer to disconnect.\n\n**Max Queue Time**: Longest wait time of any single call in queue.\n\n**Percentage of Calls Abandoned**: (Calls Abandoned / Calls Presented) × 100\n\n**Percentage of Calls Handled**: (Calls Handled / Calls Presented) × 100\n\n**Percentage of Service Level Met (Handled)**: (Calls Handled \\< Service Level / Calls Handled) × 100\n\n**Percentage of Service Level Met (With Abandoned Calls Counted Negatively)**: (Calls Handled \\< Service Level / (Calls Presented)) × 100\n\n**Percentage of Service Level Met (With Abandoned Calls Counted Positively)**: ((Calls Handled \\< Service Level + Calls Abandoned \\< Service Level) / Calls Presented) × 100\n\n**Percentage of Service Level Met (Without Abandoned Calls)**: (Calls Handled \\< Service Level / (Calls Presented - Calls Abandoned)) × 100\n\n**Service Level (sec):** The targeted time limit for answering a call once it's in the queue.\n\nAlso from Claude:\n\nThe most common service level target for municipal customer service centers is typically 80/30 - meaning 80% of calls should be answered within 30 seconds. However, actual targets can vary based on:\n\n-   Size of municipality\n\n-   Available resources\n\n-   Type of services provided\n\n-   Call complexity\n\n-   Hours of operation\n\n-   Local government priorities and budget\n\nSome municipalities use:\n\n-   70/30 (70% in 30 seconds) - For smaller centers or those with budget constraints\n\n-   80/20 (80% in 20 seconds) - For centers focusing on quick response\n\n-   90/30 (90% in 30 seconds) - For well-resourced centers prioritizing accessibility\n\nWhen you see service levels significantly below these targets (like 60% or lower), it often indicates:\n\n-   Resource constraints\n\n-   Peak period challenges\n\n-   Staffing issues\n\n-   Higher than expected call volumes\n\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n      date             holiday             year         month          \n Min.   :2019-02-26   Mode :logical   Min.   :2019   Length:1589       \n 1st Qu.:2020-03-30   FALSE:1548      1st Qu.:2020   Class :character  \n Median :2021-05-11   TRUE :41        Median :2021   Mode  :character  \n Mean   :2021-05-10                   Mean   :2021                     \n 3rd Qu.:2022-06-19                   3rd Qu.:2022                     \n Max.   :2023-07-30                   Max.   :2023                     \n   month_num        year_month         day_of_week        type_of_day       \n Min.   : 1.000   Min.   :2019-02-01   Length:1589        Length:1589       \n 1st Qu.: 4.000   1st Qu.:2020-03-01   Class :character   Class :character  \n Median : 6.000   Median :2021-05-01   Mode  :character   Mode  :character  \n Mean   : 6.372   Mean   :2021-04-25                                        \n 3rd Qu.: 9.000   3rd Qu.:2022-06-01                                        \n Max.   :12.000   Max.   :2023-07-01                                        \n weekend_holiday covid_lockdown  avg_handle_time avg_queue_time  \n Mode :logical   Mode :logical   Min.   : 51.0   Min.   :  5.00  \n FALSE:1099      FALSE:1286      1st Qu.:116.0   1st Qu.: 17.00  \n TRUE :490       TRUE :303       Median :126.0   Median : 26.00  \n                                 Mean   :128.4   Mean   : 38.47  \n                                 3rd Qu.:139.0   3rd Qu.: 44.00  \n                                 Max.   :231.0   Max.   :832.00  \n avg_speed_of_answer calls_abandoned  calls_abandoned_service_level\n Min.   :   4.00     Min.   :  0.00   Min.   :  0.00               \n 1st Qu.:  15.00     1st Qu.:  9.00   1st Qu.:  5.00               \n Median :  24.00     Median : 15.00   Median :  9.00               \n Mean   :  36.83     Mean   : 20.05   Mean   : 10.43               \n 3rd Qu.:  41.00     3rd Qu.: 25.00   3rd Qu.: 14.00               \n Max.   :1263.00     Max.   :480.00   Max.   :322.00               \n calls_handled    calls_handled_service_level calls_presented max_handle_time \n Min.   :  11.0   Min.   : 10.0               Min.   :  24    Min.   :  79.0  \n 1st Qu.: 117.0   1st Qu.: 94.0               1st Qu.: 128    1st Qu.: 688.0  \n Median : 273.0   Median :224.0               Median : 291    Median : 881.0  \n Mean   : 240.9   Mean   :196.3               Mean   : 261    Mean   : 971.7  \n 3rd Qu.: 323.0   3rd Qu.:266.0               3rd Qu.: 348    3rd Qu.:1153.0  \n Max.   :1835.0   Max.   :413.0               Max.   :1925    Max.   :5001.0  \n max_queue_time   percentage_of_calls_abandoned percentage_of_calls_handled\n Min.   :  10.0   Min.   : 0.000                Min.   : 45.80             \n 1st Qu.: 290.0   1st Qu.: 4.400                1st Qu.: 90.60             \n Median : 435.0   Median : 6.400                Median : 93.60             \n Mean   : 530.9   Mean   : 7.453                Mean   : 92.54             \n 3rd Qu.: 650.0   3rd Qu.: 9.400                3rd Qu.: 95.60             \n Max.   :5908.0   Max.   :54.200                Max.   :100.00             \n percentage_of_service_level_met_handled\n Min.   : 14.90                         \n 1st Qu.: 77.70                         \n Median : 86.40                         \n Mean   : 83.31                         \n 3rd Qu.: 91.50                         \n Max.   :100.00                         \n percentage_of_service_level_met_with_abandoned_calls_counted_negatively\n Min.   :  8.20                                                         \n 1st Qu.: 70.60                                                         \n Median : 80.80                                                         \n Mean   : 77.46                                                         \n 3rd Qu.: 87.00                                                         \n Max.   :100.00                                                         \n percentage_of_service_level_met_with_abandoned_calls_counted_positively\n Min.   : 15.80                                                         \n 1st Qu.: 75.00                                                         \n Median : 84.30                                                         \n Mean   : 81.38                                                         \n 3rd Qu.: 90.30                                                         \n Max.   :100.00                                                         \n percentage_of_service_level_met_without_abandoned_calls service_level_sec\n Min.   :  8.80                                          Min.   :30       \n 1st Qu.: 74.00                                          1st Qu.:30       \n Median : 83.80                                          Median :30       \n Mean   : 80.54                                          Mean   :30       \n 3rd Qu.: 90.00                                          3rd Qu.:30       \n Max.   :100.00                                          Max.   :30       \n total_handle_time_hrs total_queue_time_secs\n Min.   : 0.1558       Min.   :   216       \n 1st Qu.: 4.3508       1st Qu.:  3107       \n Median : 9.1000       Median :  5882       \n Mean   : 8.5554       Mean   : 11449       \n 3rd Qu.:11.4569       3rd Qu.: 12350       \n Max.   :66.7736       Max.   :458432       \n```\n\n\n:::\n:::\n\n\n\n\n\nThe \"service_level_sec\" column (the targeted time within which a call is expected to be handled) is the same for every date, so we can drop it. Also, the data begins on February 26, 2019, so only the final three days of that month are included. We will drop those as well. The period ends on July 30, 2023, so all but the final day of that month are included, so we will retain the July 2023 data.\n\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n\nWe deleted the data for 14 dates that didn't have the common set of 17 metrics. Let's see how many other dates are missing from the period covered by the data.\n\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"2019-12-25\" \"2020-06-06\" \"2020-06-07\" \"2020-06-08\" \"2020-07-05\"\n [6] \"2020-07-20\" \"2020-07-22\" \"2020-10-03\" \"2020-12-26\" \"2021-03-21\"\n[11] \"2021-04-26\" \"2021-07-25\" \"2021-10-09\" \"2021-11-10\" \"2022-01-04\"\n[16] \"2022-02-07\" \"2022-02-23\" \"2022-05-05\" \"2022-10-22\" \"2023-01-15\"\n[21] \"2023-01-16\" \"2023-05-07\" \"2023-06-30\" \"2023-07-01\" \"2023-07-02\"\n[26] \"2023-07-03\" \"2023-07-12\"\n```\n\n\n:::\n:::\n\n\n\n\n\nThere are 27 missing days during the 1,613-day period, so 13 are truly missing from the original dataset in addition to the 14 we dropped above due to odd metric sets. There is no apparent pattern to the missing days and they represent only 1.7% of the total days, so their absence will not hinder the analysis.\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/boxplots-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/hist-presented-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/hist-perc-service-level-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/hist-avg-handle-time-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/hist-avg-queue-time-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/avg-times-comparison-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/calls-presented-day-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/calls-abandoned-day-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/perc_abandoned-day-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/scatter-queuetime-calls-pres-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/scatter-handletime-calls-pres-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/scatter-queuetime-calls-aband-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/service-level-met-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/service-level-met-by-month-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon rank sum test with continuity correction\n\ndata:  before_change and after_change\nW = 428210, p-value < 2.2e-16\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  period mean_calls median_calls sd_calls n_days\n  <chr>       <dbl>        <dbl>    <dbl>  <int>\n1 After        73.5         76.6     14.1    805\n2 Before       81.5         83.7     10.7    781\n```\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/calls-by-month-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/service-level-met-jul20-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/service-level-met-may22-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/scatter-service-level-calls-pres-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 2\n  type_of_day   corr\n  <chr>        <dbl>\n1 Weekday     -0.513\n2 Weekend     -0.671\n```\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/perc-calls-aband-by-month-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/presented-abandrate-base100-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/presented-aband-base100-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/aband-pres-bar-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/perc-handled-calls-handled-in-30secs-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/perc-aband-calls-aband-30secs-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/perc-calls-aband-svclevel-by-month-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/avg-queue-time-by-month-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/avg-handle-time-by-month-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/max-handle-time-by-month-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 7 × 2\n  day_of_week     n\n  <chr>       <int>\n1 Fri           230\n2 Mon           224\n3 Sat           225\n4 Sun           224\n5 Thu           229\n6 Tue           229\n7 Wed           225\n```\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/total-calls-day-of-week-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/median-calls-day-of-week-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/aband-day-of-week-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/handle-time-day-of-week-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/queue-time-day-of-week-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/perc-handled-within-30secs-day-of-week-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/aband-after-30secs-day-of-week-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/calls-month-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/calls-month-apr20-excluded-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/aband-month-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/handle-time-month-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/queue-time-month-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/perc-handled-within-30secs-month-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/segmented-model-answered-below-30secs-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tDavies' test for a change in the slope\n\ndata:  formula = percentage_of_service_level_met_with_abandoned_calls_counted_negatively ~ date ,   method = lm \nmodel = gaussian , link = identity  \nsegmented variable = date\n'best' at = 18673, n.points = 10, p-value = 5.443e-05\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/segmented-model-pres-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tDavies' test for a change in the slope\n\ndata:  formula = calls_presented ~ date ,   method = lm \nmodel = gaussian , link = identity  \nsegmented variable = date\n'best' at = 19388, n.points = 10, p-value = 0.07222\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/segmented-model-avg-queue-time-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tDavies' test for a change in the slope\n\ndata:  formula = avg_queue_time ~ date ,   method = lm \nmodel = gaussian , link = identity  \nsegmented variable = date\n'best' at = 18672, n.points = 10, p-value = 0.0008553\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/segmented-model-aband-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tDavies' test for a change in the slope\n\ndata:  formula = percentage_of_calls_abandoned ~ date ,   method = lm \nmodel = gaussian , link = identity  \nsegmented variable = date\n'best' at = 18851, n.points = 10, p-value = 2.687e-05\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/pres-19-23-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/perc-aband-19-23-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/avg-handle-19-23-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/avg-queue-19-23-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_explore_files/figure-html/perc-handled-30secs-19-23-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "02_explore_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}